---
title: "增值税转型改革对国企和外企的影响"
author: "廖羽彤"
date: "2021/7/1"
output:
  html_document:
    df_print: paged
---

[摘要：]{style="font-family:黑体;"}本文基于2007到2010年的工业企业数据，定量地分析增值税转型改革给国有企业和外资企业带来的影响。研究发现这次改革会使得国有企业应交增值税减少，企业会扩大投资，增大企业规模和劳动投入；而外资企业应交增值税增多，为了维持利润和规模，企业会进行一定的裁员，从而导致负面的社会影响。

# 研究问题

  2009年1月1日起在全国范围实行的增值税转型改革，是将之前的生产型增值税转变为消费型增值税。生产型增值税税制只允许扣除购入的原材料所含的税金，不允许扣除购买固定资产所含的税金。这种税制在税率相同的条件下，能够比消费型增值税获得更多的财政收入，但也有不少的缺陷，一是纳税人购入的固定资产不能扣除税款，不利于鼓励投资，二是会造成不同企业之间税负不平衡，特别是对高新技术产业和基础产业这类固定资产投资比重大的行业，会造成过重的税负。相较之下，消费型增值税虽然会减少财政收入，但有利于基础产业和高新技术产业的发展，也有利于促进产业结构调整和技术升级。本文将以增值税转型作为切入点，利用2007到2010年的中国工业企业数据，通过线性拟合的方法，定量地分析增值税转型改革给国有企业和外资企业带来的影响。

# 数据与变量

## 数据

  由于1998到2006年收录的是主营收入超过500万的非国有企业，2007到2010年收录的是主营收入超过500万的国有企业和非国有企业。为了研究增值税转型改革对企业利润、规模和劳动投入的影响，以及对不同注册类型的企业的影响，故采用07到10年的数据。

  在使用该数据库的数据之前，参考史东波和张子江的做法，对数据库做了如下的处理：（1）去除每一年度里企业名称和法人代码都重复记录；（2）处理企业法人代码相同但企业名称不同的记录，做到不同的企业名称对应不同的法人代码；（3）处理企业名称相同但企业法人代码不同的记录；（4）跨年匹配并建立唯一ID。

## 变量定义

  本文使用企业利润总额来衡量企业盈利能力（profit），资产总计衡量企业规模（size），企业从业人员平均人数衡量劳动投入（labor），增值税（tax）则是用企业应交增值税表示。为了控制变量，选取的是2007年到2010年都有记录的企业。从数据库中选取数据的过程如以下代码所示。

```{r,collapse = TRUE,results='hide',message = FALSE}
library(readr)
library(dplyr)
library(ggplot2)
qy_1998 <- read_csv("qy_final.csv",n_max = 164971)
colnames <- names(qy_1998)
qy_2007 <- read_csv("qy_final.csv",skip = 1888922,n_max = 336282,col_names = colnames)
qy_2008 <- read_csv("qy_final.csv",skip = 2225204,n_max = 411601,col_names = colnames)
qy_2009 <- read_csv("qy_final.csv",skip = 2636805,n_max = 300381,col_names = colnames)
qy_2010 <- read_csv("qy_final.csv",skip = 2937186,n_max = 335634,col_names = colnames)
#筛选出07到10年都有记录的国企和外企#
qy2007guo <- filter(qy_2007,b10 == "110")
qy2007wai <- filter(qy_2007,b10 == "310" | b10 == "330")
qy2008guo <- filter(qy_2008,b10 == "110")
qy2008wai <- filter(qy_2008,b10 == "310" | b10 == "330")
qy2009guo <- filter(qy_2009,b10 == "110")
qy2009wai <- filter(qy_2009,b10 == "310" | b10 == "330")
qy2010guo <- filter(qy_2010,b10 == "110")
qy2010wai <- filter(qy_2010,b10 == "310" | b10 == "330")
guoqy <- rbind(qy2007guo,qy2008guo,qy2009guo,qy2010guo)
guoqy_1 <- guoqy %>% group_by(uid) %>% mutate(n=n()) %>% filter(n == 4) %>% arrange(uid)
waiqy <- rbind(qy2007wai,qy2008wai,qy2009wai,qy2010wai)
waiqy_1 <- waiqy %>% group_by(uid) %>% mutate(n=n()) %>% filter(n == 4) %>% arrange(uid)
guo2007 <- filter(guoqy_1,year == "2007")
wai2007 <- filter(waiqy_1,year == "2007")
guo2008 <- filter(guoqy_1,year == "2008")
wai2008 <- filter(waiqy_1,year == "2008")
guo2009 <- filter(guoqy_1,year == "2009")
wai2009 <- filter(waiqy_1,year == "2009")
guo2010 <- filter(guoqy_1,year == "2010")
wai2010 <- filter(waiqy_1,year == "2010")
```

  构建用于线性拟合的数据框如以下代码所示。

```{r,collapse = TRUE,results='hide',message = FALSE}
gq2007 <- data.frame(
    tax=guo2007$f353,
    profit=guo2007$f344,
    size=guo2007$b233,
    labor=guo2007$v210
)
gq2008 <- data.frame(
    tax=guo2008$f353,
    profit=guo2008$f344,
    size=guo2008$b233,
    labor=guo2008$v210
)
gq2009 <- data.frame(
    tax=guo2009$f353,
    profit=guo2009$f344,
    size=guo2009$b233,
    labor=guo2009$v210
)
gq2010 <- data.frame(
    tax=guo2010$f353,
    profit=guo2010$f344,
    size=guo2010$b233,
    labor=guo2010$v210
)
wq2007 <- data.frame(
    tax=wai2007$f353,
    profit=wai2007$f344,
    size=wai2007$b233,
    labor=wai2007$v210
)
wq2008 <- data.frame(
    tax=wai2008$f353,
    profit=wai2008$f344,
    size=wai2008$b233,
    labor=wai2008$v210
)
wq2009 <- data.frame(
    tax=wai2009$f353,
    profit=wai2009$f344,
    size=wai2009$b233,
    labor=wai2009$v210
)
wq2010 <- data.frame(
    tax=wai2010$f353,
    profit=wai2010$f344,
    size=wai2010$b233,
    labor=wai2010$v210
)
```

# 模型建立

  由于每个年份不同注册类型的企业的线性拟合模型的建立过程是相似的，故以下只详细说明2009年国有企业的线性模型建立过程，其余年份线性拟合的代码则放在附录。

  记应交增值税为tax，盈利能力为profit，企业规模为size，劳动投入为labor，假设基本模型为线性模型:$tax = \beta_0 + {\beta_1}profit + {\beta_2}size + {\beta_3}labor + \varepsilon$

  调用R软件中的lm函数求解，并用summary显示计算结果：

```{r,collapse = TRUE}
summary(lm(tax~profit+size+labor,data=gq2009))
```

  其结果有一个问题，就是$\beta~2~$的P值大于0.05，故绘制tax和size的散点图和回归曲线。

```{r,collapse = TRUE}
p1 <- ggplot(gq2009,aes(y = tax,x = size))
p2 <- p1 + geom_point(shape = 21,size=5,fill="white")
p2 + geom_smooth(method='lm',formula=y~x,color="red",se=F,fullrange = T)
```

  从散点图的拟合情况来看，用直线拟合的效果并不好，因此改用二次曲线进行拟合。

```{r,collapse=TRUE}
p1 <- ggplot(gq2009,aes(y = tax,x = size))
p2 <- p1 + geom_point(shape = 21,size=5,fill="white")
p2 + geom_smooth(method='lm',formula=y~x+I(x^2),color="red",se=F,fullrange = T)
```

  因此将2009年国有企业的模型改为: $$tax = \beta_0 + {\beta_1}profit + {\beta_2}size + {\beta_3}{size^2} + {\beta_4}labor + \varepsilon$$ 并以此做相应的回归分析。

```{r,collapse=TRUE}
summary(lm(tax~profit+size+I(size^2)+labor,data=gq2009))
```

  此时，可以看见所有因素都通过了T检验，并且和之前的模型相比较，残差标准误下降，R平方上升，故选取该模型作为最终模型，即: $$tax = -1508 + 0.2916\times profit + 0.04250\times size - 8.797\times 10^{-11} \times size^2 - 6.854 \times labor$$

  其他年份的线性拟合过程都与上面的过程相似，最后得到的结果如下所示。

+------+----------+--------------------------------------------------------------------------------------------------------------------+
| 年份 | 注册类型 | 模型公式                                                                                                           |
+:====:+:========:+:==================================================================================================================:+
| 2007 | 国有企业 | $tax = 617.9 + 0.5080\times profit - 0.006607\times size + 18.28\times labor$                                      |
+------+----------+--------------------------------------------------------------------------------------------------------------------+
| 2007 | 外资企业 | $tax = 1703 + 0.2119\times profit + 0.02122\times size - 9.149\times labor$                                        |
+------+----------+--------------------------------------------------------------------------------------------------------------------+
| 2008 | 国有企业 | $tax = -9731 + 0.2081\times profit + 0.004524\times size + 39.58\times labor$                                      |
+------+----------+--------------------------------------------------------------------------------------------------------------------+
| 2008 | 外资企业 | $tax = -1026 + 0.03702\times profit + 0.02879\times size + 4.921\times labor$                                      |
+------+----------+--------------------------------------------------------------------------------------------------------------------+
| 2009 | 国有企业 | $tax = -1508 + 0.2916\times profit + 0.04250\times size - 8.797\times 10^{-11} \times size^2 - 6.854 \times labor$ |
+------+----------+--------------------------------------------------------------------------------------------------------------------+
| 2009 | 外资企业 | $tax = 1101 + 0.2794\times profit + 0.01717\times size - 7.042\times labor$                                        |
+------+----------+--------------------------------------------------------------------------------------------------------------------+
| 2010 | 国有企业 | $tax = 617.9 + 0.5080\times profit - 0.006607\times size + 18.28\times labor$                                      |
+------+----------+--------------------------------------------------------------------------------------------------------------------+
| 2010 | 外资企业 | $tax = 1703 + 0.2119\times profit + 0.02122\times size - 9.149\times labor$                                        |
+------+----------+--------------------------------------------------------------------------------------------------------------------+

# 结果分析

  从结果拟合的情况来看，可以非常惊讶的发现，2007年的结果和2010年的结果完全一样。而后查看了一下原始数据，奇怪的是这两个年份的应交增值税、企业利润总额、企业资产总计和企业从业人员平均人数这四项数据完全一样。因而这两个年份的数据并不可靠，所以最后用于分析增值税转型改革对企业影响的数据只有2008年和2009年的。

  单单从2008年的拟合结果来看，无论是国有企业还是外资企业，公司盈利能力、企业规模和劳动投入对于应交增值税的影响都是正向的，也就是说这三项数据的提升会导致应交增值税的增多。但是其中外资企业的线性拟合模型的R方仅有0.4853，也就说在实际情况中，外资企业应交增值税的大小应该还受到其他一些政策或者因素的影响。国有企业的R方有0.6398，相较而言还是比较能够解释应交增值税的大小变化的。

  从2009年的拟合结果来看，两种企业的劳动投入对应交增值税的影响都变成负方向的了。但是国有企业的企业规模对应交增值税的拟合变成二次曲线，且企业规模的二次项对应交增值税产生负向影响，一次项则仍是正向影响，而外资企业仍然是一次曲线。国有企业的R方为0.817，外资企业为0.734，说明这两个模型的拟合情况都比较好，而且明显好于2008年。

  将这两个年份的结果进行对比，可以明显看出这次增值税转型改革使得国有企业的应交增值税有所减少，并且相较于2008年，劳动投入对应交增值税的影响变成负向，企业应该会招收更多的员工，有利于提高就业率，公司总资产也会因为这次改革而增多，但是利润由于还有成本的影响，无法确定其具体是增多还是减少。本次改革应该会使得外资企业的应交增值税增多，虽然改革后劳动投入对增值税影响变成负向的了，但为了维持利润和公司资产，外资企业应该会进行一定程度的裁员，造成一定的负面社会影响。

### 附录

  线性拟合的代码如下所示。

```{r,collapse=TRUE,message = FALSE}
#2007年#
lmguo2007 <- summary(lm(tax~profit+size+labor,data=gq2007))
print('2007年国有企业：')
lmguo2007
lmwai2007 <- summary(lm(tax~profit+size+labor,data=wq2007))
print('2007年外资企业：')
lmwai2007
#2008年#
lmguo2008 <- summary(lm(tax~profit+size+labor,data=gq2008))
print('2008年国有企业：')
lmguo2008
lmwai2008 <- summary(lm(tax~profit+size+labor,data=wq2008))
print('2008年外资企业：')
lmwai2008
#2009年#
lmwai2009 <- summary(lm(tax~profit+size+labor,data=wq2009))
print('2009年外资企业：')
lmwai2009
#2010年#
lmguo2010 <- summary(lm(tax~profit+size+labor,data=gq2010))
print('2010年国有企业：')
lmguo2010
lmwai2010 <- summary(lm(tax~profit+size+labor,data=wq2010))
print('2010年外资企业：')
lmwai2010
```
